function sendTrialData(trialNumber, speed, time) {
  const participantId = localStorage.getItem('participantId');
  const payload = {
    participantId,
    trial: trialNumber,
    playbackSpeed: speed,
    videoTime: time
  };

  // Send to your Node.js backend
  fetch('https://speed-of-speech-perception.onrender.com/submit', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(payload)
  }).then(() => {
    // After backend save, send email
    emailjs.send('service_speed_perception', 'template_60hcc4f', {
      participant_id: participantId,
      trial_number: trialNumber,
      playback_speed: speed,
      video_time: time
    }).then(response => {
      console.log('Email sent successfully', response.status, response.text);
    }).catch(error => {
      console.error('Email failed to send', error);
    });
  }).catch(error => {
    console.error("Failed to send to backend", error);
  });
}
